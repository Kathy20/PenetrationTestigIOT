###############################################################
#             Instituto Tecnologico de Costa Rica             #
#                  Maestria en Computacion                    #
#                                                             #
#   Estudiante                                                #
#   Kathy Brenes Guerrero                                     #
#                                                             #
#   Fecha                                                     # 
#   Marzo 2021                                                #
###############################################################

####### Import Section #####
from Firmware.Firmware import scan_firmware
from Cryptography.Cryptography import scan_cryptography
from Network.Network import scan_network

########## Body ########
def draw_fallen_petals():
    fallen_petals = [
        "  .  ", " . . ", " . . ", "  .  ",
        " . . ", " . . ", " . . ", " . . ",
        "  .  ", " . . ", " . . ", "  .  "
    ]

    for _ in range(1):
        for petal in fallen_petals:
            print(petal * 10)

def menu():
    draw_fallen_petals()
    print('###################################################')
    print('#  *   *    *   *   *  *  *  *  *  *   *   *   *  #')
    print('#    *    *        *     *     *     *   *   *    #')
    print('#   000 000  000 000   *    *     *    *   *   *  #')
    print('#   | | | |  | | | |     *     *     *   *    *   #')
    print('#   000 000  000 000        *     *    *    *     #')
    print('#     ####   #####   ++++++++++++++++++++  *   *  #')
    print('#      ##     ##     + ANDROID EXPLOIT  +    *    #')
    print('#     ####   ####    +        BY        +  *   *  #')
    print('#      ##     ##     +      KATHY       +    *    #')
    print('#      ###   ###     ++++++++++++++++++++  *   *  #')
    print('#         ###      *    *   *    *    *      *    #')
    print('#       ######   *   *    *    *    *    *  *  *  #')
    print('#     ##########   *   *    *    *    *       *   #')
    print('###################################################')
    draw_fallen_petals()
    print('')
    print('')

def option1():
    print("You selected Option 1 - Web Interface Vulnerability")
    #detectWAF

def option2():
    print("You selected Option 2 - Network")
    scan_network
def option3():
    print("You selected Option 3 - Cryptografy")
    scan_cryptography()
def option4():
    print("You selected Option 4 - Firmware")
    scan_firmware()
def exit_menu():
    print("Exiting the menu.")
    exit()

# Define the menu options and associated functions
menu_options = {
    '1': option1,
    '2': option2,
    '3': option3,
    '4': option4,
    '0': exit_menu
}

def pentest_tool():
    while True:
        # Display the menu
        menu()
        print("\nMenu:")
        print(' [1] Web Interface Vulnerability')
        print(' [2] Network')
        print(' [3] Cryptografy')
        print(' [4] Firmware')
        print(' [0] Quit')
        print('')
        print(' Option: ')


        # Get user input for menu selection
        choice = input("Enter your choice: ").strip().lower()

        # Check if the choice is valid
        if choice in menu_options:
            # Call the selected function
            menu_options[choice]()
        else:
            print("Invalid choice. Please select a valid option.")

pentest_tool()